---
title: "Chi-square GOF"
author: "Maria Zarifyan"
date: "15 December 2020"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# install.packages("devtools")
# devtools::install_github("ebbertd/chisq.posthoc.test")
```


```{r}
 #https://github.com/cran/RVAideMemoire/blob/master/R/chisq.multcomp.R

chisq.multcomp <-
function(x,p.method="fdr") {
  x <- sort(x)
  fun.p <- function(i,j) {
    xi <- x[i]
    xj <- x[j]
    suppressWarnings(chisq.test(c(xi, xj)))$p.value
  }
  tab.p <- pairwise.table(fun.p,as.character(x),p.adjust.method=p.method)
  call <- match.call()
  dname.x <- if(length(call$x)==1) {call$x} else {paste(call$x[1],"(",paste(call$x[-1],collapse=","),")",sep="")}
  result <- list(method="chi-squared tests",data.name=dname.x,p.adjust.method=p.method,p.value=tab.p)
  class(result) <- "pairwise.htest"
  return(result)
}
```

##Group close-close-meton
LM1 = literal + meton1
LM2 = literal + meton2
M1M2 = meton1 + meton2
LM1M2 = literal + meton1 + meton2
```{r}
baskets = c(LM1=594, LM2=401, M1M2=1263, LM1M2=567)
sum(baskets)
```


```{r}
chisq.test(baskets)
```
```{r}
chisq.multcomp(baskets)
```


##Group close-meton
LM = literal + meton
LMf = literal + metaph
MM = metaph + meton
LMM = literal + meton + metaph


```{r}
baskets2 = c(LMf=86, LM=1278, MM=556, LMM=134)
sum(baskets2)
```
```{r}
chisq.test(baskets2)
```

```{r}
chisq.multcomp(baskets2)

```


##Group close-far-meton
L_Far = literal + far_meton
L_Close = literal + close_meton
MM = close_meton + far_meton
LMM = literal + close_meton + far_meton
```{r}
baskets3 = c(L_far=401, L_Close=761, MM=780, LMM=505)
sum(baskets3)
```

```{r}
chisq.test(baskets3)
```
```{r}
chisq.multcomp(baskets3)

```


##Group far-meton
L_Mf = literal + metaph
L_meton = literal + far_meton
MM = metaph + far_meton
LMM = literal + metaph + far_meton
```{r}
baskets4 = c(L_Mf=141, L_meton=963, MM=512, LMM=106)
sum(baskets4)
```
```{r}
chisq.test(baskets4)
```

```{r}
chisq.multcomp(baskets4)
```
